{% extends "base.html" %}

{% block title %}Component types - Velo Supervisor 2000{% endblock %}

{% block content %}
<h1 id="component-types" class="display-5 mt-5 text-center">Component types</h1>

<button type="button" class="btn btn-outline-primary mt-4" data-bs-toggle="modal" data-bs-target="#componentTypeModal">
    <span>üè∑ New component type</span>
</button>

{% include "modal_component_type.html" %}

<hr/>
<div class="mb-2 ms-2 small text-secondary d-flex align-items-center gap-3">
    <span>‚≠ê Mandatory on all bikes</span>
    <span>üü© In use by one or more components</span>
    <span>üü• Not used by any components</span>
</div>
<div class="card shadow mb-3">
    <div class="card-header fw-bold">All component types</div>
    <div class="card-body">
        <div class="input-group mb-3">
            <span class="input-group-text">üîç</span>
            <input type="text" class="form-control" id="componentTypeSearchInput" placeholder="Search component types..." aria-label="Search component types">
        </div>
        <div class="table-responsive">
        <table class="table table-hover">
            <thead>
                <tr>
                    <th class="text-center"></th>
                    <th>Type</th>
                    <th>Max pr bike</th>
                    <th>Status use</th>
                    <th>Life (km)</th>
                    <th>Service (km)</th>
                    <th>Thresh (km)</th>
                    <th>Life (days)</th>
                    <th>Service (days)</th>
                    <th>Thresh (days)</th>
                    <th class="text-end"></th>
                </tr>
            </thead>
            <tbody>
                {% if payload.component_types %}
                    {% for component_type, expected_lifetime, lifetime_expected_days, service_interval, service_interval_days, threshold_km, threshold_days, in_use, mandatory, max_quantity in payload.component_types %}
                    <tr data-row-id="{{ loop.index0 }}"
                        data-component-type="{{ component_type }}"
                        data-expected-lifetime="{{ expected_lifetime if expected_lifetime else '' }}"
                        data-lifetime-expected-days="{{ lifetime_expected_days if lifetime_expected_days else '' }}"
                        data-service-interval="{{ service_interval if service_interval else '' }}"
                        data-service-interval-days="{{ service_interval_days if service_interval_days else '' }}"
                        data-threshold-km="{{ threshold_km if threshold_km else '' }}"
                        data-threshold-days="{{ threshold_days if threshold_days else '' }}"
                        data-max-quantity="{{ max_quantity if max_quantity else '' }}"
                        data-mandatory="{{ mandatory }}">
                        <td class="text-center">{% if mandatory == "Yes" %}‚≠ê{% endif %}</td>
                        <td>{{ component_type }}</td>
                        <td>{% if max_quantity == None or max_quantity == 0 %}-{% else %}{{ max_quantity }}{% endif %}</td>
                        <td>{% if in_use > 0 %}üü© {{ in_use }} components{% else %}üü• No components{% endif %}</td>
                        <td>{% if expected_lifetime == None or expected_lifetime == 0 %}-{% else %}{{ expected_lifetime }}{% endif %}</td>
                        <td>{% if service_interval == None or service_interval == 0 %}-{% else %}{{ service_interval }}{% endif %}</td>
                        <td>{% if threshold_km == None or threshold_km == 0 %}-{% else %}{{ threshold_km }}{% endif %}</td>
                        <td>{% if lifetime_expected_days == None or lifetime_expected_days == 0 %}-{% else %}{{ lifetime_expected_days }}{% endif %}</td>
                        <td>{% if service_interval_days == None or service_interval_days == 0 %}-{% else %}{{ service_interval_days }}{% endif %}</td>
                        <td>{% if threshold_days == None or threshold_days == 0 %}-{% else %}{{ threshold_days }}{% endif %}</td>
                        <td class="text-end">                    
                            <button type="button" class="mb-1 btn btn-outline-success btn-sm modify-record"
                                    component_type="{{ component_type }}"
                                    data-row-id="{{ loop.index0 }}">
                                    ‚úç
                            </button>
                            <button type="button" class="mb-1 btn btn-outline-danger btn-sm delete-record"
                                    data-component-type="{{ component_type }}">
                                    üóë
                            </button>
                        </td>
                    </tr>
                    {% endfor %}
                    {% else %}
                    <tr>
                        <td colspan="4" class="text-center">No component types defined</td>
                    </tr>
                {% endif %}
            </tbody>
        </table>
        </div>
    </div>
</div>
{% endblock %}